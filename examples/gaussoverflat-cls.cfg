@include "gaussoverflat-include.cfg"

// the recommended test statistic producer for CLS upper limits for now is
// deltanll_hypotest where the background-only-distributions fixes the signal to zero
// and signal-plus-background either uses a flat prior.
deltanll = {
    type = "deltanll_hypotest";
    name = "deltanll";
    minimizer = "@myminuit";
    background-only-distribution = {
         type = "product_distribution";
         distributions=("@b-dist", "@delta-s-zero");
    };
    signal-plus-background-distribution = "@gaussoverflat.parameter-distribution";
};

delta-s-zero = {
   type = "delta_distribution";
   s = 0.0;
};

// note: for complex models, minuit might have trouble converging. If the error rate
// is too high (say > 5-10%, or it fails on data), consider using a chain of minimizers
// which also include mcmc_minimizer.
myminuit = {
   type = "root_minuit";
};

main = {
   type = "cls_limits";
   producers = ("@deltanll");
   model = "@gaussoverflat";
   output_database = {
        type = "sqlite_database";
        filename = "gaussoverflat-cls.db";
    };
    minimizer = "@myminuit";
    
    // the name of the test statistic column:
    ts_column = "deltanll__nll_diff";
    truth_parameter = "s";
    
    // for debugging only. Not really needed in case everything is Ok. If something fails, please include
    // the debug log in you error report to the developer:
    debuglog = "debug-gaussoverflat-cls.txt";
};

options = {
  plugin_files = ("$THETA_DIR/lib/core-plugins.so", "$THETA_DIR/lib/root.so");
};

